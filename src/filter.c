// #############################################################################
// Source file: filter.c

// The author disclaims copyright to this source code.  In place of
// a legal notice, here is a blessing:
//
//    May you do good and not evil.
//    May you find forgiveness for yourself and forgive others.
//    May you share freely, never taking more than you give.

// #############################################################################
// includes of local headers
//

#include "main.h"
#include "filter.h"

#include "strlcpy.h"
#include "strlcat.h"

// #############################################################################
// global variables
//

char unix_file_validate[] =
{
/* +       0 ,    1 ,    2 ,    3 ,    4 ,    5 ,    6 ,    7 ,    8 ,    9 ,    A ,    B ,    C ,    D ,    E ,    F , */
/* 00 */   0 ,    0 ,    0 ,    0 ,    0 ,    0 ,    0 ,    0 ,    0 ,    0 ,    0 ,    0 ,    0 ,    0 ,    0 ,    0 ,
/* 10 */   0 ,    0 ,    0 ,    0 ,    0 ,    0 ,    0 ,    0 ,    0 ,    0 ,    0 ,    0 ,    0 ,    0 ,    0 ,    0 ,
/* 20 */  ' ',   '!',   '"',   '#',   '$',   '%',   '&',   '\'',  '(',   ')',   '*',   '+',   ',',   '-',   '.',    0,
/* 30 */  '0',   '1',   '2',   '3',   '4',   '5',   '6',   '7',   '8',   '9',   ':',   ';',   '<',   '=',   '>',   '?',
/* 40 */  '@',   'A',   'B',   'C',   'D',   'E',   'F',   'G',   'H',   'I',   'J',   'K',   'L',   'M',   'N',   'O',
/* 50 */  'P',   'Q',   'R',   'S',   'T',   'U',   'V',   'W',   'X',   'Y',   'Z',   '[',   '\\',  ']',   '^',   '_',
/* 60 */  '`',   'a',   'b',   'c',   'd',   'e',   'f',   'g',   'h',   'i',   'j',   'k',   'l',   'm',   'n',   'o',
/* 70 */  'p',   'q',   'r',   's',   't',   'u',   'v',   'w',   'x',   'y',   'z',   '{',   '|',   '}',   '~',    0 ,
/* 80 */ 0x080, 0x081, 0x082, 0x083, 0x084, 0x085, 0x086, 0x087, 0x088, 0x089, 0x08A, 0x08B, 0x08C, 0x08D, 0x08E, 0x08F,
/* 90 */ 0x090, 0x091, 0x092, 0x093, 0x094, 0x095, 0x096, 0x097, 0x098, 0x099, 0x09A, 0x09B, 0x09C, 0x09D, 0x09E, 0x09F,
/* A0 */ 0x0A0, 0x0A1, 0x0A2, 0x0A3, 0x0A4, 0x0A5, 0x0A6, 0x0A7, 0x0A8, 0x0A9, 0x0AA, 0x0AB, 0x0AC, 0x0AD, 0x0AE, 0x09F,
/* B0 */ 0x0B0, 0x0B1, 0x0B2, 0x0B3, 0x0B4, 0x0B5, 0x0B6, 0x0B7, 0x0B8, 0x0B9, 0x0BA, 0x0BB, 0x0BC, 0x0BD, 0x0BE, 0x0BF,
/* C0 */ 0x0C0, 0x0C1, 0x0C2, 0x0C3, 0x0C4, 0x0C5, 0x0C6, 0x0C7, 0x0C8, 0x0C9, 0x0CA, 0x0CB, 0x0CC, 0x0CD, 0x0CE, 0x0CF,
/* D0 */ 0x0D0, 0x0D1, 0x0D2, 0x0D3, 0x0D4, 0x0D5, 0x0D6, 0x0D7, 0x0D8, 0x0D9, 0x0DA, 0x0DB, 0x0DC, 0x0DD, 0x0DE, 0x0DF,
/* E0 */ 0x0E0, 0x0E1, 0x0E2, 0x0E3, 0x0E4, 0x0E5, 0x0E6, 0x0E7, 0x0E8, 0x0E9, 0x0EA, 0x0EB, 0x0EC, 0x0ED, 0x0EE, 0x0EF,
/* F0 */ 0x0F0, 0x0F1, 0x0F2, 0x0F3, 0x0F4, 0x0F5, 0x0F6, 0x0F7, 0x0F8, 0x0F9, 0x0FA, 0x0FB, 0x0FC, 0x0FD, 0x0FE, 0x0FF,
};

char printable_validate[] =
{
/* +       0 ,   1 ,   2 ,   3 ,   4 ,   5 ,   6 ,   7 ,   8 ,   9 ,   A ,   B ,   C ,   D ,   E ,   F , */
/* 00 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 10 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 20 */  ' ',  '!',  '"',  '#',  '$',  '%',  '&',  '\'', '(',  ')',  '*',  '+',  ',',  '-',  '.',  '/',
/* 30 */  '0',  '1',  '2',  '3',  '4',  '5',  '6',  '7',  '8',  '9',  ':',  ';',  '<',  '=',  '>',  '?',
/* 40 */  '@',  'A',  'B',  'C',  'D',  'E',  'F',  'G',  'H',  'I',  'J',  'K',  'L',  'M',  'N',  'O',
/* 50 */  'P',  'Q',  'R',  'S',  'T',  'U',  'V',  'W',  'X',  'Y',  'Z',  '[',  '\\', ']',  '^',  '_',
/* 60 */  '`',  'a',  'b',  'c',  'd',  'e',  'f',  'g',  'h',  'i',  'j',  'k',  'l',  'm',  'n',  'o',
/* 70 */  'p',  'q',  'r',  's',  't',  'u',  'v',  'w',  'x',  'y',  'z',  '{',  '|',  '}',  '~',   0 ,
/* 80 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 90 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* A0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* B0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* C0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* D0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* E0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* F0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
};

char alphanum_validate[] =
{
/* +       0 ,   1 ,   2 ,   3 ,   4 ,   5 ,   6 ,   7 ,   8 ,   9 ,   A ,   B ,   C ,   D ,   E ,   F , */
/* 00 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 10 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 20 */  ' ',   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 30 */  '0',  '1',  '2',  '3',  '4',  '5',  '6',  '7',  '8',  '9',   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 40 */   0 ,  'A',  'B',  'C',  'D',  'E',  'F',  'G',  'H',  'I',  'J',  'K',  'L',  'M',  'N',  'O',
/* 50 */  'P',  'Q',  'R',  'S',  'T',  'U',  'V',  'W',  'X',  'Y',  'Z',   0 ,   0 ,   0 ,   0 ,   0 ,
/* 60 */   0 ,  'a',  'b',  'c',  'd',  'e',  'f',  'g',  'h',  'i',  'j',  'k',  'l',  'm',  'n',  'o',
/* 70 */  'p',  'q',  'r',  's',  't',  'u',  'v',  'w',  'x',  'y',  'z',   0 ,   0 ,   0 ,   0 ,   0 ,
/* 80 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 90 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* A0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* B0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* C0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* D0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* E0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* F0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
};

char numeric_validate[] =
{
/* +       0 ,   1 ,   2 ,   3 ,   4 ,   5 ,   6 ,   7 ,   8 ,   9 ,   A ,   B ,   C ,   D ,   E ,   F , */
/* 00 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 10 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 20 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 30 */  '0',  '1',  '2',  '3',  '4',  '5',  '6',  '7',  '8',  '9',   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 40 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 50 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 60 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 70 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 80 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 90 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* A0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* B0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* C0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* D0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* E0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* F0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
};

char alphanum_underscore_validate[] =
{
/* +       0 ,   1 ,   2 ,   3 ,   4 ,   5 ,   6 ,   7 ,   8 ,   9 ,   A ,   B ,   C ,   D ,   E ,   F , */
/* 00 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 10 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 20 */  ' ',   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 30 */  '0',  '1',  '2',  '3',  '4',  '5',  '6',  '7',  '8',  '9',   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 40 */   0 ,  'A',  'B',  'C',  'D',  'E',  'F',  'G',  'H',  'I',  'J',  'K',  'L',  'M',  'N',  'O',
/* 50 */  'P',  'Q',  'R',  'S',  'T',  'U',  'V',  'W',  'X',  'Y',  'Z',   0 ,   0 ,   0 ,   0 ,  '_',
/* 60 */   0 ,  'a',  'b',  'c',  'd',  'e',  'f',  'g',  'h',  'i',  'j',  'k',  'l',  'm',  'n',  'o',
/* 70 */  'p',  'q',  'r',  's',  't',  'u',  'v',  'w',  'x',  'y',  'z',   0 ,   0 ,   0 ,   0 ,   0 ,
/* 80 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* 90 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* A0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* B0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* C0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* D0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* E0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
/* F0 */   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,   0 ,
};

// #############################################################################

// Replace tables (0x05F = '_')
char alphanum_filter[] =
{
/* +        00,    01,    02,    03,    04,    05,    06,    07,    08,    09,    0A,    0B,    0C,    0D,    0E,    0F, */
/* 00 */ 0x000, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 10 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 20 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 30 */ 0x030, 0x031, 0x032, 0x033, 0x034, 0x035, 0x036, 0x037, 0x038, 0x039, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 40 */ 0x05F, 0x041, 0x042, 0x043, 0x044, 0x045, 0x046, 0x047, 0x048, 0x049, 0x04A, 0x04B, 0x04C, 0x04D, 0x04E, 0x04F,
/* 50 */ 0x050, 0x051, 0x052, 0x053, 0x054, 0x055, 0x056, 0x057, 0x058, 0x059, 0x05A, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 60 */ 0x05F, 0x061, 0x062, 0x063, 0x064, 0x065, 0x066, 0x067, 0x068, 0x069, 0x06A, 0x06B, 0x06C, 0x06D, 0x06E, 0x06F,
/* 70 */ 0x070, 0x071, 0x072, 0x073, 0x074, 0x075, 0x076, 0x077, 0x078, 0x079, 0x07A, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 80 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 90 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* A0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* B0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* C0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* D0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* E0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* F0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
};
char usernameFilter_cp1251[] =
{
/* +        00,    01,    02,    03,    04,    05,    06,    07,    08,    09,    0A,    0B,    0C,    0D,    0E,    0F, */
/* 00 */ 0x000, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 10 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 20 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 30 */ 0x030, 0x031, 0x032, 0x033, 0x034, 0x035, 0x036, 0x037, 0x038, 0x039, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 40 */ 0x05F, 0x041, 0x042, 0x043, 0x044, 0x045, 0x046, 0x047, 0x048, 0x049, 0x04A, 0x04B, 0x04C, 0x04D, 0x04E, 0x04F,
/* 50 */ 0x050, 0x051, 0x052, 0x053, 0x054, 0x055, 0x056, 0x057, 0x058, 0x059, 0x05A, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 60 */ 0x05F, 0x061, 0x062, 0x063, 0x064, 0x065, 0x066, 0x067, 0x068, 0x069, 0x06A, 0x06B, 0x06C, 0x06D, 0x06E, 0x06F,
/* 70 */ 0x070, 0x071, 0x072, 0x073, 0x074, 0x075, 0x076, 0x077, 0x078, 0x079, 0x07A, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 80 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 90 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* A0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* B0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* C0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* D0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* E0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* F0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
};
char nicknameFilter_cp1251[] =
{
/* +        00,    01,    02,    03,    04,    05,    06,    07,    08,    09,    0A,    0B,    0C,    0D,    0E,    0F, */
/* 00 */ 0x000, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 10 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 20 */ 0x020, 0x021, 0x022, 0x023, 0x024, 0x025, 0x026, 0x027, 0x028, 0x029, 0x02A, 0x02B, 0x02C, 0x02D, 0x02E, 0x02F,
/* 30 */ 0x030, 0x031, 0x032, 0x033, 0x034, 0x035, 0x036, 0x037, 0x038, 0x039, 0x03A, 0x03B, 0x03C, 0x03D, 0x03E, 0x03F,
/* 40 */ 0x040, 0x041, 0x042, 0x043, 0x044, 0x045, 0x046, 0x047, 0x048, 0x049, 0x04A, 0x04B, 0x04C, 0x04D, 0x04E, 0x04F,
/* 50 */ 0x050, 0x051, 0x052, 0x053, 0x054, 0x055, 0x056, 0x057, 0x058, 0x059, 0x05A, 0x05B, 0x05C, 0x05D, 0x05E, 0x05F,
/* 60 */ 0x060, 0x061, 0x062, 0x063, 0x064, 0x065, 0x066, 0x067, 0x068, 0x069, 0x06A, 0x06B, 0x06C, 0x06D, 0x06E, 0x06F,
/* 70 */ 0x070, 0x071, 0x072, 0x073, 0x074, 0x075, 0x076, 0x077, 0x078, 0x079, 0x07A, 0x07B, 0x07C, 0x07D, 0x07E, 0x07F,
/* 80 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 90 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* A0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* B0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* C0 */ 0x0C0, 0x0C1, 0x0C2, 0x0C3, 0x0C4, 0x0C5, 0x0C6, 0x0C7, 0x0C8, 0x0C9, 0x0CA, 0x0CB, 0x0CC, 0x0CD, 0x0CE, 0x0CF,
/* D0 */ 0x0D0, 0x0D1, 0x0D2, 0x0D3, 0x0D4, 0x0D5, 0x0D6, 0x0D7, 0x0D8, 0x0D9, 0x0DA, 0x0DB, 0x0DC, 0x0DD, 0x0DE, 0x0DF,
/* E0 */ 0x0E0, 0x0E1, 0x0E2, 0x0E3, 0x0E4, 0x0E5, 0x0E6, 0x0E7, 0x0E8, 0x0E9, 0x0EA, 0x0EB, 0x0EC, 0x0ED, 0x0EE, 0x0EF,
/* F0 */ 0x0F0, 0x0F1, 0x0F2, 0x0F3, 0x0F4, 0x0F5, 0x0F6, 0x0F7, 0x0F8, 0x0F9, 0x0FA, 0x0FB, 0x0FC, 0x0FD, 0x0FE, 0x0FF,
};
char passwordFilter_cp1251[] =
{
/* +        00,    01,    02,    03,    04,    05,    06,    07,    08,    09,    0A,    0B,    0C,    0D,    0E,    0F, */
/* 00 */ 0x000, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 10 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 20 */ 0x020, 0x021, 0x022, 0x023, 0x024, 0x025, 0x026, 0x027, 0x028, 0x029, 0x02A, 0x02B, 0x02C, 0x02D, 0x02E, 0x02F,
/* 30 */ 0x030, 0x031, 0x032, 0x033, 0x034, 0x035, 0x036, 0x037, 0x038, 0x039, 0x03A, 0x03B, 0x03C, 0x03D, 0x03E, 0x03F,
/* 40 */ 0x040, 0x041, 0x042, 0x043, 0x044, 0x045, 0x046, 0x047, 0x048, 0x049, 0x04A, 0x04B, 0x04C, 0x04D, 0x04E, 0x04F,
/* 50 */ 0x050, 0x051, 0x052, 0x053, 0x054, 0x055, 0x056, 0x057, 0x058, 0x059, 0x05A, 0x05B, 0x05C, 0x05D, 0x05E, 0x05F,
/* 60 */ 0x060, 0x061, 0x062, 0x063, 0x064, 0x065, 0x066, 0x067, 0x068, 0x069, 0x06A, 0x06B, 0x06C, 0x06D, 0x06E, 0x06F,
/* 70 */ 0x070, 0x071, 0x072, 0x073, 0x074, 0x075, 0x076, 0x077, 0x078, 0x079, 0x07A, 0x07B, 0x07C, 0x07D, 0x07E, 0x07F,
/* 80 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 90 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* A0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* B0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* C0 */ 0x0C0, 0x0C1, 0x0C2, 0x0C3, 0x0C4, 0x0C5, 0x0C6, 0x0C7, 0x0C8, 0x0C9, 0x0CA, 0x0CB, 0x0CC, 0x0CD, 0x0CE, 0x0CF,
/* D0 */ 0x0D0, 0x0D1, 0x0D2, 0x0D3, 0x0D4, 0x0D5, 0x0D6, 0x0D7, 0x0D8, 0x0D9, 0x0DA, 0x0DB, 0x0DC, 0x0DD, 0x0DE, 0x0DF,
/* E0 */ 0x0E0, 0x0E1, 0x0E2, 0x0E3, 0x0E4, 0x0E5, 0x0E6, 0x0E7, 0x0E8, 0x0E9, 0x0EA, 0x0EB, 0x0EC, 0x0ED, 0x0EE, 0x0EF,
/* F0 */ 0x0F0, 0x0F1, 0x0F2, 0x0F3, 0x0F4, 0x0F5, 0x0F6, 0x0F7, 0x0F8, 0x0F9, 0x0FA, 0x0FB, 0x0FC, 0x0FD, 0x0FE, 0x0FF,
};
char emailFilter_cp1251[] =
{
/* +        00,    01,    02,    03,    04,    05,    06,    07,    08,    09,    0A,    0B,    0C,    0D,    0E,    0F, */
/* 00 */ 0x000, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 10 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 20 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x02E, 0x05F,
/* 30 */ 0x030, 0x031, 0x032, 0x033, 0x034, 0x035, 0x036, 0x037, 0x038, 0x039, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 40 */ 0x040, 0x041, 0x042, 0x043, 0x044, 0x045, 0x046, 0x047, 0x048, 0x049, 0x04A, 0x04B, 0x04C, 0x04D, 0x04E, 0x04F,
/* 50 */ 0x050, 0x051, 0x052, 0x053, 0x054, 0x055, 0x056, 0x057, 0x058, 0x059, 0x05A, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 60 */ 0x05F, 0x061, 0x062, 0x063, 0x064, 0x065, 0x066, 0x067, 0x068, 0x069, 0x06A, 0x06B, 0x06C, 0x06D, 0x06E, 0x06F,
/* 70 */ 0x070, 0x071, 0x072, 0x073, 0x074, 0x075, 0x076, 0x077, 0x078, 0x079, 0x07A, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 80 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 90 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* A0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* B0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* C0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* D0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* E0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* F0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
};
char pathFilter[256] =
{
/* +        00,    01,    02,    03,    04,    05,    06,    07,    08,    09,    0A,    0B,    0C,    0D,    0E,    0F, */
/* 00 */ 0x000, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 10 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 20 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x028, 0x029, 0x05F, 0x05F, 0x05F, 0x02D, 0x02E, 0x02F,
/* 30 */ 0x030, 0x031, 0x032, 0x033, 0x034, 0x035, 0x036, 0x037, 0x038, 0x039, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 40 */ 0x05F, 0x041, 0x042, 0x043, 0x044, 0x045, 0x046, 0x047, 0x048, 0x049, 0x04A, 0x04B, 0x04C, 0x04D, 0x04E, 0x04F,
/* 50 */ 0x050, 0x051, 0x052, 0x053, 0x054, 0x055, 0x056, 0x057, 0x058, 0x059, 0x05A, 0x05B, 0x05F, 0x05D, 0x05F, 0x05F,
/* 60 */ 0x05F, 0x061, 0x062, 0x063, 0x064, 0x065, 0x066, 0x067, 0x068, 0x069, 0x06A, 0x06B, 0x06C, 0x06D, 0x06E, 0x06F,
/* 70 */ 0x070, 0x071, 0x072, 0x073, 0x074, 0x075, 0x076, 0x077, 0x078, 0x079, 0x07A, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 80 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 90 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* A0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* B0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* C0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* D0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* E0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* F0 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
};
char queryFilter[256] =
{
/* +        00,    01,    02,    03,    04,    05,    06,    07,    08,    09,    0A,    0B,    0C,    0D,    0E,    0F, */
/* 00 */ 0x000, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 10 */ 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F, 0x05F,
/* 20 */ 0x020, 0x021, 0x022, 0x023, 0x024, 0x025, 0x026, 0x057, 0x028, 0x029, 0x02A, 0x02B, 0x02C, 0x02D, 0x02E, 0x02F,
/* 30 */ 0x030, 0x031, 0x032, 0x033, 0x034, 0x035, 0x036, 0x037, 0x038, 0x039, 0x03A, 0x03B, 0x03C, 0x03D, 0x03E, 0x03F,
/* 40 */ 0x040, 0x041, 0x042, 0x043, 0x044, 0x045, 0x046, 0x047, 0x048, 0x049, 0x04A, 0x04B, 0x04C, 0x04D, 0x04E, 0x04F,
/* 50 */ 0x050, 0x051, 0x052, 0x053, 0x054, 0x055, 0x056, 0x057, 0x058, 0x059, 0x05A, 0x05B, 0x05C, 0x05D, 0x05E, 0x05F,
/* 60 */ 0x060, 0x061, 0x062, 0x063, 0x064, 0x065, 0x066, 0x067, 0x068, 0x069, 0x06A, 0x06B, 0x06C, 0x06D, 0x06E, 0x06F,
/* 70 */ 0x070, 0x071, 0x072, 0x073, 0x074, 0x075, 0x076, 0x077, 0x078, 0x079, 0x07A, 0x07B, 0x07C, 0x07D, 0x07E, 0x07F,
/* 80 */ 0x080, 0x081, 0x082, 0x083, 0x084, 0x085, 0x086, 0x087, 0x088, 0x089, 0x08A, 0x08B, 0x08C, 0x08D, 0x08E, 0x08F,
/* 90 */ 0x090, 0x091, 0x092, 0x093, 0x094, 0x095, 0x096, 0x097, 0x098, 0x099, 0x09A, 0x09B, 0x09C, 0x09D, 0x09E, 0x09F,
/* A0 */ 0x0A0, 0x0A1, 0x0A2, 0x0A3, 0x0A4, 0x0A5, 0x0A6, 0x0A7, 0x0A8, 0x0A9, 0x0AA, 0x0AB, 0x0AC, 0x0AD, 0x0AE, 0x0AF,
/* B0 */ 0x0B0, 0x0B1, 0x0B2, 0x0B3, 0x0B4, 0x0B5, 0x0B6, 0x0B7, 0x0B8, 0x0B9, 0x0BA, 0x0BB, 0x0BC, 0x0BD, 0x0BE, 0x0BF,
/* C0 */ 0x0C0, 0x0C1, 0x0C2, 0x0C3, 0x0C4, 0x0C5, 0x0C6, 0x0C7, 0x0C8, 0x0C9, 0x0CA, 0x0CB, 0x0CC, 0x0CD, 0x0CE, 0x0CF,
/* D0 */ 0x0D0, 0x0D1, 0x0D2, 0x0D3, 0x0D4, 0x0D5, 0x0D6, 0x0D7, 0x0D8, 0x0D9, 0x0DA, 0x0DB, 0x0DC, 0x0DD, 0x0DE, 0x0DF,
/* E0 */ 0x0E0, 0x0E1, 0x0E2, 0x0E3, 0x0E4, 0x0E5, 0x0E6, 0x0E7, 0x0E8, 0x0E9, 0x0EA, 0x0EB, 0x0EC, 0x0ED, 0x0EE, 0x0EF,
/* F0 */ 0x0F0, 0x0F1, 0x0F2, 0x0F3, 0x0F4, 0x0F5, 0x0F6, 0x0F7, 0x0F8, 0x0F9, 0x0FA, 0x0FB, 0x0FC, 0x0FD, 0x0FE, 0x0FF,
};
char numericFilter[256] =
{
/* +        00,    01,    02,    03,    04,    05,    06,    07,    08,    09,    0A,    0B,    0C,    0D,    0E,    0F, */
/* 00 */ 0x000, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030,
/* 10 */ 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030,
/* 20 */ 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030,
/* 30 */ 0x030, 0x031, 0x032, 0x033, 0x034, 0x035, 0x036, 0x037, 0x038, 0x039, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030,
/* 40 */ 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030,
/* 50 */ 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030,
/* 60 */ 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030,
/* 70 */ 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030,
/* 80 */ 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030,
/* 90 */ 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030,
/* A0 */ 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030,
/* B0 */ 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030,
/* C0 */ 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030,
/* D0 */ 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030,
/* E0 */ 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030,
/* F0 */ 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030, 0x030
};
char noFilter[] =
{
/* +        00,    01,    02,    03,    04,    05,    06,    07,    08,    09,    0A,    0B,    0C,    0D,    0E,    0F, */
/* 00 */ 0x000, 0x001, 0x002, 0x003, 0x004, 0x005, 0x006, 0x007, 0x008, 0x009, 0x00A, 0x00B, 0x00C, 0x00D, 0x00E, 0x00F,
/* 10 */ 0x010, 0x011, 0x012, 0x013, 0x014, 0x015, 0x016, 0x017, 0x018, 0x019, 0x01A, 0x01B, 0x01C, 0x01D, 0x01E, 0x01F,
/* 20 */ 0x020, 0x021, 0x022, 0x023, 0x024, 0x025, 0x026, 0x027, 0x028, 0x029, 0x02A, 0x02B, 0x02C, 0x02D, 0x02E, 0x02F,
/* 30 */ 0x030, 0x031, 0x032, 0x033, 0x034, 0x035, 0x036, 0x037, 0x038, 0x039, 0x03A, 0x03B, 0x03C, 0x03D, 0x03E, 0x03F,
/* 40 */ 0x040, 0x041, 0x042, 0x043, 0x044, 0x045, 0x046, 0x047, 0x048, 0x049, 0x04A, 0x04B, 0x04C, 0x04D, 0x04E, 0x04F,
/* 50 */ 0x050, 0x051, 0x052, 0x053, 0x054, 0x055, 0x056, 0x057, 0x058, 0x059, 0x05A, 0x05B, 0x05C, 0x05D, 0x05E, 0x05F,
/* 60 */ 0x060, 0x061, 0x062, 0x063, 0x064, 0x065, 0x066, 0x067, 0x068, 0x069, 0x06A, 0x06B, 0x06C, 0x06D, 0x06E, 0x06F,
/* 70 */ 0x070, 0x071, 0x072, 0x073, 0x074, 0x075, 0x076, 0x077, 0x078, 0x079, 0x07A, 0x07B, 0x07C, 0x07D, 0x07E, 0x07F,
/* 80 */ 0x080, 0x081, 0x082, 0x083, 0x084, 0x085, 0x086, 0x087, 0x088, 0x089, 0x08A, 0x08B, 0x08C, 0x08D, 0x08E, 0x08F,
/* 90 */ 0x090, 0x091, 0x092, 0x093, 0x094, 0x095, 0x096, 0x097, 0x098, 0x099, 0x09A, 0x09B, 0x09C, 0x09D, 0x09E, 0x09F,
/* A0 */ 0x0A0, 0x0A1, 0x0A2, 0x0A3, 0x0A4, 0x0A5, 0x0A6, 0x0A7, 0x0A8, 0x0A9, 0x0AA, 0x0AB, 0x0AC, 0x0AD, 0x0AE, 0x09F,
/* B0 */ 0x0B0, 0x0B1, 0x0B2, 0x0B3, 0x0B4, 0x0B5, 0x0B6, 0x0B7, 0x0B8, 0x0B9, 0x0BA, 0x0BB, 0x0BC, 0x0BD, 0x0BE, 0x0BF,
/* C0 */ 0x0C0, 0x0C1, 0x0C2, 0x0C3, 0x0C4, 0x0C5, 0x0C6, 0x0C7, 0x0C8, 0x0C9, 0x0CA, 0x0CB, 0x0CC, 0x0CD, 0x0CE, 0x0CF,
/* D0 */ 0x0D0, 0x0D1, 0x0D2, 0x0D3, 0x0D4, 0x0D5, 0x0D6, 0x0D7, 0x0D8, 0x0D9, 0x0DA, 0x0DB, 0x0DC, 0x0DD, 0x0DE, 0x0DF,
/* E0 */ 0x0E0, 0x0E1, 0x0E2, 0x0E3, 0x0E4, 0x0E5, 0x0E6, 0x0E7, 0x0E8, 0x0E9, 0x0EA, 0x0EB, 0x0EC, 0x0ED, 0x0EE, 0x0EF,
/* F0 */ 0x0F0, 0x0F1, 0x0F2, 0x0F3, 0x0F4, 0x0F5, 0x0F6, 0x0F7, 0x0F8, 0x0F9, 0x0FA, 0x0FB, 0x0FC, 0x0FD, 0x0FE, 0x0FF,
};
char uriFilter[] =
{
/* +        00,    01,    02,    03,    04,    05,    06,    07,    08,    09,    0A,    0B,    0C,    0D,    0E,    0F, */
/* 00 */ 0x000, 0x001, 0x002, 0x003, 0x004, 0x005, 0x006, 0x007, 0x008, 0x009, 0x00A, 0x00B, 0x00C, 0x00D, 0x00E, 0x00F,
/* 10 */ 0x010, 0x011, 0x012, 0x013, 0x014, 0x015, 0x016, 0x017, 0x018, 0x019, 0x01A, 0x01B, 0x01C, 0x01D, 0x01E, 0x01F,
/* 20 */     0, 0x021,     0,     0,     0,     0,     0,     0, 0x028, 0x029, 0x02A,     0,     0, 0x02D, 0x02E,     0,
/* 30 */ 0x030, 0x031, 0x032, 0x033, 0x034, 0x035, 0x036, 0x037, 0x038, 0x039,     0,     0,     0,     0,     0,     0,
/* 40 */     0, 0x041, 0x042, 0x043, 0x044, 0x045, 0x046, 0x047, 0x048, 0x049, 0x04A, 0x04B, 0x04C, 0x04D, 0x04E, 0x04F,
/* 50 */ 0x050, 0x051, 0x052, 0x053, 0x054, 0x055, 0x056, 0x057, 0x058, 0x059, 0x05A,     0,     0,     0,     0, 0x05F,
/* 60 */     0, 0x061, 0x062, 0x063, 0x064, 0x065, 0x066, 0x067, 0x068, 0x069, 0x06A, 0x06B, 0x06C, 0x06D, 0x06E, 0x06F,
/* 70 */ 0x070, 0x071, 0x072, 0x073, 0x074, 0x075, 0x076, 0x077, 0x078, 0x079, 0x07A,     0,     0,     0,     0, 0x07F,
/* 80 */ 0x080, 0x081, 0x082, 0x083, 0x084, 0x085, 0x086, 0x087, 0x088, 0x089, 0x08A, 0x08B, 0x08C, 0x08D, 0x08E, 0x08F,
/* 90 */ 0x090, 0x091, 0x092, 0x093, 0x094, 0x095, 0x096, 0x097, 0x098, 0x099, 0x09A, 0x09B, 0x09C, 0x09D, 0x09E, 0x09F,
/* A0 */ 0x0A0, 0x0A1, 0x0A2, 0x0A3, 0x0A4, 0x0A5, 0x0A6, 0x0A7, 0x0A8, 0x0A9, 0x0AA, 0x0AB, 0x0AC, 0x0AD, 0x0AE, 0x09F,
/* B0 */ 0x0B0, 0x0B1, 0x0B2, 0x0B3, 0x0B4, 0x0B5, 0x0B6, 0x0B7, 0x0B8, 0x0B9, 0x0BA, 0x0BB, 0x0BC, 0x0BD, 0x0BE, 0x0BF,
/* C0 */ 0x0C0, 0x0C1, 0x0C2, 0x0C3, 0x0C4, 0x0C5, 0x0C6, 0x0C7, 0x0C8, 0x0C9, 0x0CA, 0x0CB, 0x0CC, 0x0CD, 0x0CE, 0x0CF,
/* D0 */ 0x0D0, 0x0D1, 0x0D2, 0x0D3, 0x0D4, 0x0D5, 0x0D6, 0x0D7, 0x0D8, 0x0D9, 0x0DA, 0x0DB, 0x0DC, 0x0DD, 0x0DE, 0x0DF,
/* E0 */ 0x0E0, 0x0E1, 0x0E2, 0x0E3, 0x0E4, 0x0E5, 0x0E6, 0x0E7, 0x0E8, 0x0E9, 0x0EA, 0x0EB, 0x0EC, 0x0ED, 0x0EE, 0x0EF,
/* F0 */ 0x0F0, 0x0F1, 0x0F2, 0x0F3, 0x0F4, 0x0F5, 0x0F6, 0x0F7, 0x0F8, 0x0F9, 0x0FA, 0x0FB, 0x0FC, 0x0FD, 0x0FE, 0x0FF,
};

// #############################################################################
// functions

char *filter_str_to_ptr( char *str, struct NNCMS_VARIABLE *vars )
{
    if( str == NULL || *str == 0 )
        return vars[0].value.string;

    for( unsigned int i = 0; vars[i].type != NNCMS_TYPE_NONE; i = i + 1 )
    {
        if( strcmp( str, vars[i].name ) == 0 )
            return vars[i].value.string;
    }
    
    // First is default
    return vars[0].value.string;
}

int filter_str_to_int( char *str, struct NNCMS_VARIABLE *vars )
{
    if( str == NULL || *str == 0 )
        return vars[0].value.integer;

    for( unsigned int i = 0; vars[i].type != NNCMS_TYPE_NONE; i = i + 1 )
    {
        if( strcmp( str, vars[i].name ) == 0 )
            return vars[i].value.integer;
    }
    
    // First is default
    return vars[0].value.integer;
}

char *filter_int_to_str( int val, struct NNCMS_VARIABLE *vars )
{
    for( unsigned int i = 0; vars[i].type != NNCMS_TYPE_NONE; i = i + 1 )
    {
        if( val == vars[i].value.integer )
            return vars[i].name;
    }
    
    // First is default
    return 0;
}

// #############################################################################

// Table replace
void filter_table_replace( char *dest, size_t nLen, char *table )
{
    // Standart indices
    unsigned int i;

    // Loop thru all characters and replace them
    for( i = 0; i < nLen; ++i )
    {
        // Very fucking simple
        if( dest[i] == 0 ) break;
        dest[i] = table[(unsigned char) dest[i]];
    }
}

// #############################################################################

bool filter_option_validation( char *buff, struct NNCMS_SELECT_OPTIONS *options )
{
    if( options->items != NULL )
    {
        for( unsigned int i = 0; options->items[i].name != NULL; i = i + 1 )
        {
            if( strcmp( buff, options->items[i].name ) == 0 )
                return true;
        }
    }
    
    return false;
}

// #############################################################################

bool filter_table_validation( char *buff, char *table )
{
    // Loop thru all characters and validate them
    for( size_t i = 0; buff[i] != 0; i = i + 1 )
    {
        unsigned char c = (unsigned char) buff[i];
        if( table[c] == 0 ) return false;
    }
    
    return true;
}

// #############################################################################

//        low=3  high=9
//          |     |
// str = "abcdefghijk"; // false
// str = "ab";          // false
// str = "abcdehijk";   // true
// str = "abcde";       // true
// str = "abc";         // true
bool filter_size_limit( char *buff, size_t low, size_t high )
{
    // Standart indices
    size_t i;

    // Loop thru all characters and count them
    for( i = 0; buff[i] != 0; ++i )
    {
        if( i >= high )
            return false;
    }
    
    if( i < low )
        return false;
    
    return true;
}

// #############################################################################

int filter_validate( char *buff, struct NNCMS_FILTER *options )
{
    return 0;
}

// #############################################################################

// Function for truncating a string
void filter_truncate_string( char *dest, size_t nLen )
{
    // Iterator
    unsigned int i;
    
    for( i = 0; i < nLen; i++ )
    {
        if( dest[i] == 0 )
            break;
    }
    
    dest[i] = 0;
    
    //if( strlen( dest ) >= nLen )
    //    dest[nLen] = '\0';
}

// #############################################################################

// Filter path name
void filter_path( char *lpszPath, unsigned char bBeginSlash, unsigned char bEndSlash )
{
    // Check for special case, when an empty path is given
    if( lpszPath[0] == 0 )
    {
        if( bBeginSlash == 1 || bEndSlash == 1 )
        {
            lpszPath[0] = '/';
            lpszPath[1] = 0;
        }

        // Exit anyway, nothing to do here
        return;
    }

    // Remove unnecessary characters from path name
    //filter_table_replace( lpszPath, NNCMS_PATH_LEN_MAX, pathFilter );

    // Remove double slashes and double dots
    unsigned int i = 0; unsigned int j = 0;
    for( i = 0; i < NNCMS_PATH_LEN_MAX; i++ )
    {
        lpszPath[j] = lpszPath[i];
        if( lpszPath[i] == 0 ) break;
        if( (lpszPath[j] != '/' || lpszPath[i + 1] != '/') &&
            (lpszPath[j] != '.' || lpszPath[i + 1] != '.') )
        {
            j++;
        }
    }

    // Remove begining slash if needed
    if( bBeginSlash == 0 && lpszPath[0] == '/' )
    {
        strlcpy( lpszPath, &lpszPath[1], NNCMS_PATH_LEN_MAX );
    }

    // Add beginning slash if needed
    if( bBeginSlash == 1 && lpszPath[0] != '/' )
    {
        char szTemp[NNCMS_PATH_LEN_MAX];
        snprintf( szTemp, sizeof(szTemp), "/%s", lpszPath );
        strlcpy( lpszPath, szTemp, NNCMS_PATH_LEN_MAX );
    }

    // Remove end slash if needed
    unsigned int lSize = strlen( lpszPath );
    if( bEndSlash == 0 && lpszPath[lSize] == '/' )
    {
        lpszPath[lSize] = 0;
    }

    // Add end slash if needed
    if( bEndSlash == 1 && lpszPath[lSize] != '/' )
    {
        lpszPath[lSize - 1] = '/';
        lpszPath[lSize] = 0;

        // WTF?
        //lpszPath[lSize] = '/';
        //lpszPath[lSize + 1] = 0;
    }

}

// #############################################################################
